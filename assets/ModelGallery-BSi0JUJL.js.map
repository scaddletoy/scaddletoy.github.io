{"version":3,"file":"ModelGallery-BSi0JUJL.js","sources":["../../node_modules/primereact/badge/badge.esm.js","../../src/pages/ModelGallery.tsx"],"sourcesContent":["'use client';\nimport * as React from 'react';\nimport { PrimeReactContext } from 'primereact/api';\nimport { ComponentBase, useHandleStyle } from 'primereact/componentbase';\nimport { useMergeProps } from 'primereact/hooks';\nimport { classNames, ObjectUtils } from 'primereact/utils';\n\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\n\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\n\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\n\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\n\nvar classes = {\n  root: function root(_ref) {\n    var props = _ref.props;\n    return classNames('p-badge p-component', _defineProperty({\n      'p-badge-no-gutter': ObjectUtils.isNotEmpty(props.value) && String(props.value).length === 1,\n      'p-badge-dot': ObjectUtils.isEmpty(props.value),\n      'p-badge-lg': props.size === 'large',\n      'p-badge-xl': props.size === 'xlarge'\n    }, \"p-badge-\".concat(props.severity), props.severity !== null));\n  }\n};\nvar styles = \"\\n@layer primereact {\\n    .p-badge {\\n        display: inline-block;\\n        border-radius: 10px;\\n        text-align: center;\\n        padding: 0 .5rem;\\n    }\\n    \\n    .p-overlay-badge {\\n        position: relative;\\n    }\\n    \\n    .p-overlay-badge .p-badge {\\n        position: absolute;\\n        top: 0;\\n        right: 0;\\n        transform: translate(50%,-50%);\\n        transform-origin: 100% 0;\\n        margin: 0;\\n    }\\n    \\n    .p-badge-dot {\\n        width: .5rem;\\n        min-width: .5rem;\\n        height: .5rem;\\n        border-radius: 50%;\\n        padding: 0;\\n    }\\n    \\n    .p-badge-no-gutter {\\n        padding: 0;\\n        border-radius: 50%;\\n    }\\n}\\n\";\nvar BadgeBase = ComponentBase.extend({\n  defaultProps: {\n    __TYPE: 'Badge',\n    __parentMetadata: null,\n    value: null,\n    severity: null,\n    size: null,\n    style: null,\n    className: null,\n    children: undefined\n  },\n  css: {\n    classes: classes,\n    styles: styles\n  }\n});\n\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nvar Badge = /*#__PURE__*/React.memo(/*#__PURE__*/React.forwardRef(function (inProps, ref) {\n  var mergeProps = useMergeProps();\n  var context = React.useContext(PrimeReactContext);\n  var props = BadgeBase.getProps(inProps, context);\n  var _BadgeBase$setMetaDat = BadgeBase.setMetaData(_objectSpread({\n      props: props\n    }, props.__parentMetadata)),\n    ptm = _BadgeBase$setMetaDat.ptm,\n    cx = _BadgeBase$setMetaDat.cx,\n    isUnstyled = _BadgeBase$setMetaDat.isUnstyled;\n  useHandleStyle(BadgeBase.css.styles, isUnstyled, {\n    name: 'badge'\n  });\n  var elementRef = React.useRef(null);\n  React.useImperativeHandle(ref, function () {\n    return {\n      props: props,\n      getElement: function getElement() {\n        return elementRef.current;\n      }\n    };\n  });\n  var rootProps = mergeProps({\n    ref: elementRef,\n    style: props.style,\n    className: classNames(props.className, cx('root'))\n  }, BadgeBase.getOtherProps(props), ptm('root'));\n  return /*#__PURE__*/React.createElement(\"span\", rootProps, props.value);\n}));\nBadge.displayName = 'Badge';\n\nexport { Badge };\n","import React, { CSSProperties, useEffect, useState } from 'react';\nimport {\n  SupabaseService,\n  ViewModel,\n  ViewModelFilterCriteria,\n} from '../services/SupabaseService.ts';\nimport { ModelCard } from '../components/ModelCard';\nimport { Paginator } from 'primereact/paginator';\nimport { Badge } from 'primereact/badge';\nimport { CenteredSpinner } from '../components/CenteredSpinner.tsx';\nimport { useParams } from 'react-router-dom';\n\nexport interface ModelGalleryProps {\n  filter?: ViewModelFilterCriteria;\n  style?: CSSProperties;\n  pageSize?: number;\n  pagination?: boolean;\n}\n\nexport default function ModelGallery({\n  filter,\n  style,\n  pageSize = 20,\n  pagination = true,\n}: ModelGalleryProps) {\n  const { tag } = useParams();\n  if (tag) filter = { ...filter, tag };\n\n  const [models, setModels] = useState<ViewModel[]>([]);\n  const [total, setTotal] = useState<number>(0);\n  const [first, setFirst] = useState<number>(0);\n  const [loading, setLoading] = useState(true);\n  const [visibleTags, setVisibleTags] = useState<{ tag: string; count: number }[]>([]);\n\n  useEffect(() => {\n    async function loadModels() {\n      const { models, total } = await SupabaseService.fetchModels(filter, first, pageSize);\n      setModels(models);\n      setTotal(total);\n      // Count occurrences of each tag\n      const tagCounts: Record<string, number> = {};\n      models.forEach((model) => {\n        (model.tags || []).forEach((tag) => {\n          tagCounts[tag] = (tagCounts[tag] || 0) + 1;\n        });\n      });\n      // Convert to array and sort by count descending, then alphabetically\n      const sortedTags = Object.entries(tagCounts)\n        .map(([tag, count]) => ({ key: tag, tag, count }))\n        .sort((a, b) => b.count - a.count || a.tag.localeCompare(b.tag));\n      setVisibleTags(sortedTags);\n      setLoading(false);\n    }\n\n    loadModels();\n  }, [first, pageSize, filter]);\n\n  function renderGalleryHeading(filter: ViewModelFilterCriteria | undefined) {\n    if (!filter) return <></>;\n    const wrap = (s: string) => <span style={{ color: 'var(--theme-color)' }}>{s}</span>;\n    const heading: React.ReactNode[] = [<>Models</>];\n    if (filter.tag) heading.push(<> tagged with {wrap(filter.tag)}</>);\n    if (filter.author) heading.push(<> authored by {wrap(filter.author)}</>);\n    if (filter.likedByUsername) heading.push(<> liked by {wrap(filter.likedByUsername)}</>);\n    if (filter.commentedByUsername)\n      heading.push(<> commented by {wrap(filter.commentedByUsername)}</>);\n    if (filter.searchTerm) heading.push(<> containing {wrap(filter.searchTerm)}</>);\n    return (\n      <h1 style={{ flex: 0, marginLeft: 'auto', marginRight: 'auto', marginBottom: 0 }}>\n        {heading}\n      </h1>\n    );\n  }\n\n  return (\n    <div style={{ ...style, display: 'flex', flexDirection: 'column', gap: 16, width: '100%' }}>\n      {renderGalleryHeading(filter)}\n      {loading ?\n        <CenteredSpinner text=\"Loading models\" />\n      : <>\n          <div className=\"model-gallery\">\n            {models.map((model) => (\n              <ModelCard key={model.id} model={model} />\n            ))}\n            {models.length === 0 && <div style={{ gridColumn: '1 / -1' }}>No models found.</div>}\n          </div>\n          {pagination && total > pageSize && (\n            <Paginator\n              first={first}\n              rows={pageSize}\n              totalRecords={total}\n              onPageChange={(e) => setFirst(e.first)}\n              template=\"PrevPageLink PageLinks NextPageLink\"\n              rowsPerPageOptions={[]}\n              style={{ flex: 0, marginLeft: 'auto', marginRight: 'auto' }}\n            />\n          )}\n          {visibleTags && visibleTags.length > 0 && (\n            <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8 }}>\n              {visibleTags.map(({ tag, count }) => (\n                <a key={tag} href={`/#/tag/${tag}`} className=\"p-button p-button-outlined\">\n                  #{tag}\n                  <Badge key={tag} value={count} style={{ background: '#333' }}></Badge>\n                </a>\n              ))}\n            </div>\n          )}\n        </>\n      }\n    </div>\n  );\n}\n"],"names":["_typeof","o","toPrimitive","t","r","e","i","toPropertyKey","_defineProperty","classes","_ref","props","classNames","ObjectUtils","styles","BadgeBase","ComponentBase","ownKeys","_objectSpread","Badge","React.memo","React.forwardRef","inProps","ref","mergeProps","useMergeProps","context","React.useContext","PrimeReactContext","_BadgeBase$setMetaDat","ptm","cx","isUnstyled","useHandleStyle","elementRef","React.useRef","React.useImperativeHandle","rootProps","React.createElement","ModelGallery","filter","style","pageSize","pagination","tag","useParams","models","setModels","useState","total","setTotal","first","setFirst","loading","setLoading","visibleTags","setVisibleTags","useEffect","loadModels","SupabaseService","tagCounts","model","sortedTags","count","a","b","renderGalleryHeading","jsx","Fragment","wrap","s","heading","jsxs","CenteredSpinner","ModelCard","Paginator"],"mappings":"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","x_google_ignoreList":[0]}