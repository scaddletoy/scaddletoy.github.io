import{r as c,u as ut,P as on,C as un,a as sn,A as cn,n as tt,B as ln,m as dn,b as ne,d as mn,e as fn,D as k,c as ye,f as be,Z as we,O,h as nt,F as vn,k as pn,U as bn,j as ce,l as yn,M as In}from"../index.js";import{d as gn,r as xn,g as hn,T as Sn,a as En,l as kn}from"./tree.esm-DaHbQoQK.js";import{C as st}from"./index.esm-Byjr6lLE.js";import{b as Pn}from"./utils-DRB1n_X_.js";import"./index.esm-DyIK9W92.js";function G(){return G=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},G.apply(null,arguments)}function Ie(t){"@babel/helpers - typeof";return Ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Ie(t)}function wn(t,a){if(Ie(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,a);if(Ie(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function Mn(t){var a=wn(t,"string");return Ie(a)=="symbol"?a:a+""}function ct(t,a,n){return(a=Mn(a))in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t}function Ln(t){if(Array.isArray(t))return t}function Rn(t,a){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var s,o,M,y,b=[],_=!0,T=!1;try{if(M=(n=n.call(t)).next,a===0){if(Object(n)!==n)return;_=!1}else for(;!(_=(s=M.call(n)).done)&&(b.push(s.value),b.length!==a);_=!0);}catch(D){T=!0,o=D}finally{try{if(!_&&n.return!=null&&(y=n.return(),Object(y)!==y))return}finally{if(T)throw o}}return b}}function rt(t,a){(a==null||a>t.length)&&(a=t.length);for(var n=0,s=Array(a);n<a;n++)s[n]=t[n];return s}function Cn(t,a){if(t){if(typeof t=="string")return rt(t,a);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(t,a):void 0}}function On(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(t,a){return Ln(t)||Rn(t,a)||Cn(t,a)||On()}var Kn=`
@layer primereact {
    .p-contextmenu ul {
        margin: 0;
        padding: 0;
        list-style: none;
    }

    .p-contextmenu .p-submenu-list {
        position: absolute;
        min-width: 100%;
        z-index: 1;
    }

    .p-contextmenu .p-menuitem-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none;
        overflow: hidden;
        position: relative;
    }

    .p-contextmenu .p-menuitem-text {
        line-height: 1;
    }

    .p-contextmenu .p-menuitem {
        position: relative;
    }

    .p-contextmenu .p-menuitem-link .p-submenu-icon {
        margin-left: auto;
    }

    .p-contextmenu-enter {
        opacity: 0;
    }

    .p-contextmenu-enter-active {
        opacity: 1;
        transition: opacity 250ms;
    }
}
`,_n={root:function(a){var n=a.context;return be("p-contextmenu p-component",{"p-input-filled":n&&n.inputStyle==="filled"||ye.inputStyle==="filled","p-ripple-disabled":n&&n.ripple===!1||ye.ripple===!1})},menu:function(a){var n=a.menuProps;return be({" p-contextmenu-root-list":n.root,"p-submenu-list":!n.root})},menuitem:function(a){var n=a.item,s=a.active,o=a.focused,M=a.disabled;return be("p-menuitem",{"p-menuitem-active p-highlight":s,"p-focus":o,"p-disabled":M},n.className)},action:function(a){var n=a.item;return be("p-menuitem-link",{"p-disabled":n.disabled})},content:"p-menuitem-content",icon:"p-menuitem-icon",submenuIcon:"p-submenu-icon",label:"p-menuitem-text",separator:"p-menuitem-separator",transition:"p-contextmenu",submenuTransition:"p-contextmenusub"},Me=un.extend({defaultProps:{__TYPE:"ContextMenu",id:null,ariaLabel:null,ariaLabelledby:null,model:null,style:null,className:null,global:!1,autoZIndex:!0,baseZIndex:0,tabIndex:0,breakpoint:void 0,scrollHeight:"400px",appendTo:null,transitionOptions:null,onFocus:null,onBlur:null,onShow:null,onHide:null,submenuIcon:null,children:void 0},css:{classes:_n,styles:Kn}});function at(t,a){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,s)}return n}function it(t){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?at(Object(n),!0).forEach(function(s){ct(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}var He=c.memo(c.forwardRef(function(t,a){var n=ut(),s=c.useRef(null),o=t.root||!t.resetMenu,M=t.ptm,y=t.cx,b=function(r,f,v){return M(f,{hostName:t.hostName,context:{active:U(r),focused:re(r),disabled:F(r),index:v}})},_=function(r,f){if(f.disabled||t.isMobileMode){r.preventDefault();return}t.onItemMouseEnter({originalEvent:r,processedItem:f})},T=function(r,f){var v=f.item;if(v.disabled){r.preventDefault();return}v.command&&v.command({originalEvent:r,item:v}),t.onItemClick({originalEvent:r,processedItem:f,isFocus:!0}),v.items||t.onLeafClick(r),v.url||(r.preventDefault(),r.stopPropagation())},D=function(){if(!t.isMobileMode){var r=s.current.parentElement,f=k.getOffset(r),v=k.getViewport(),H=s.current.offsetParent?s.current.offsetWidth:k.getHiddenElementOuterWidth(s.current),B=k.getOuterWidth(r.children[0]),m=parseInt(f.top,10)+s.current.offsetHeight-k.getWindowScrollTop();m>v.height?s.current.style.top=v.height-m+"px":s.current.style.top="0px",parseInt(f.left,10)+B+H>v.width-k.calculateScrollbarWidth()?s.current.style.left=-1*H+"px":s.current.style.left=B+"px"}},R=function(){D()};ne(function(){o&&D()});var K=function(r){return"".concat(t.menuId,"_").concat(r.key)},$=function(r,f,v){return r&&r.item?O.getItemValue(r.item[f],v):void 0},U=function(r){return t.activeItemPath&&t.activeItemPath.some(function(f){return f.key===r.key})},N=function(r){return $(r,"visible")!==!1},F=function(r){return $(r,"disabled")},re=function(r){return t.focusedItemId===K(r)},V=function(r){return O.isNotEmpty(r.items)},X=function(){return t.model.filter(function(r){return N(r)&&!$(r,"separator")}).length},d=function(r){return r-t.model.slice(0,r).filter(function(f){return N(f)&&$(f,"separator")}).length+1};c.useImperativeHandle(a,function(){return{props:t,getElement:function(){return s.current}}});var h=function(r){var f=t.id+"_separator_"+r,v=n({id:f,className:y("separator"),role:"separator"},M("separator",{hostName:t.hostName}));return c.createElement("li",G({},v,{key:f}))},p=function(r,f){return V(r)?c.createElement(He,{id:t.id+"_"+f,role:"menu",menuId:t.menuId,focusedItemId:t.focusedItemId,activeItemPath:t.activeItemPath,level:t.level+1,hostName:t.hostName,ariaLabelledby:K(r),menuProps:t.menuProps,model:r.items,resetMenu:!U(r),onLeafClick:t.onLeafClick,onItemClick:t.onItemClick,onItemMouseEnter:t.onItemMouseEnter,isMobileMode:t.isMobileMode,submenuIcon:t.submenuIcon,ptm:M,cx:y}):null},I=function(r,f){if(!N(r))return null;var v=r.item,H=U(r),B=F(r),m=re(r),L=V(r),ge=K(r),xe=n({className:y("icon")},b(r,"icon",f)),C=nt.getJSXIcon(v.icon,it({},xe),{props:t.menuProps}),Z=n({className:y("submenuIcon")},b(r,"submenuIcon",f)),Re=n({className:y("label")},b(r,"label",f)),he=$(r,"items"),Se=he&&nt.getJSXIcon(t.submenuIcon||c.createElement(vn,Z),it({},Z),{props:t.menuProps}),Ce=v.label&&c.createElement("span",Re,v.label),Oe=p(r,f),Ee=n({href:v.url||"#",tabIndex:-1,className:y("action",{item:v}),target:v.target},b(r,"action",f)),P=c.createElement("a",Ee,C,Ce,Se,c.createElement(pn,null));if(v.template){var Ke={className:"p-menuitem-link",labelClassName:"p-menuitem-text",iconClassName:"p-menuitem-icon",submenuIconClassName:y("submenuIcon"),element:P,props:t,active:H};P=O.getJSXElement(v.template,v,Ke)}var _e=n({onClick:function(le){return T(le,r)},onMouseEnter:function(le){return _(le,r)},className:y("content")},b(r,"content",f)),ke=n({id:ge,role:"menuitem","aria-label":v.label,"aria-disabled":B,"aria-expanded":L?H:void 0,"aria-haspopup":L&&!v.url?"menu":void 0,"aria-level":t.level+1,"aria-setsize":X(),"aria-posinset":d(f),"data-p-highlight":H,"data-p-focused":m,"data-p-disabled":B,className:y("menuitem",{item:v,active:H,focused:m,disabled:F(v)}),style:v.style},b(r,"menuitem",f));return c.createElement("li",G({},ke,{key:ge}),c.createElement("div",_e,P),Oe)},J=function(r,f){return r.visible===!1?null:r.separator?h(f):I(r,f)},q=function(){return t.model?t.model.map(J):null},j=q(),Y=n({className:y("menu",{menuProps:t}),onFocus:t.onFocus,onBlur:t.onBlur,onKeyDown:t.onKeyDown,"aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabelledby,"aria-orientation":"vertical","aria-activedescendant":t.ariaActivedescendant,tabIndex:t.tabIndex,role:t.role},M("menu",{hostName:t.hostName})),z=n({classNames:y("submenuTransition"),in:o,timeout:{enter:0,exit:0},unmountOnExit:!0,onEnter:R},M("menu.transition",{hostName:t.hostName}));return c.createElement(st,G({nodeRef:s},z),c.createElement("ul",G({ref:s},Y),j))}));He.displayName="ContextMenuSub";function ot(t,a){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,s)}return n}function Le(t){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?ot(Object(n),!0).forEach(function(s){ct(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}var lt=c.memo(c.forwardRef(function(t,a){var n=ut(),s=c.useContext(on),o=Me.getProps(t,s),M=c.useState(o.id),y=w(M,2),b=y[0],_=y[1],T=c.useState(!1),D=w(T,2),R=D[0],K=D[1],$=c.useState(!1),U=w($,2),N=U[0],F=U[1],re=c.useState(!1),V=w(re,2),X=V[0],d=V[1],h=c.useState(null),p=w(h,2),I=p[0],J=p[1],q=c.useState(!1),j=w(q,2),Y=j[0],z=j[1],g=c.useState(!1),r=w(g,2),f=r[0],v=r[1],H=c.useState({index:-1,level:0,parentKey:""}),B=w(H,2),m=B[0],L=B[1],ge=c.useState(""),xe=w(ge,2),C=xe[0],Z=xe[1],Re=c.useState([]),he=w(Re,2),Se=he[0],Ce=he[1],Oe=c.useState([]),Ee=w(Oe,2),P=Ee[0],Ke=Ee[1],_e=c.useState(null),ke=w(_e,2),ae=ke[0],le=ke[1],De=Me.setMetaData({props:o,state:{id:b,visible:R,reshow:N,resetMenu:X,attributeSelector:I}}),Ne=De.ptm,je=De.cx,dt=De.isUnstyled;sn(Me.css.styles,dt,{name:"contextmenu"});var x=c.useRef(null),Q=c.useRef(null),ie=c.useRef(null),W=c.useRef(""),Pe=c.useRef(null),de=c.useRef(null),mt=cn("screen and (max-width: ".concat(o.breakpoint,")"),!!o.breakpoint),ft=tt({type:"click",listener:function(e){Rt(e)&&e.button!==2&&(ee(e),d(!0))}}),Ue=w(ft,2),vt=Ue[0],pt=Ue[1],bt=tt({type:"contextmenu",when:o.global,listener:function(e){Ae(e)}}),yt=w(bt,1),Ve=yt[0],It=ln({listener:function(e){R&&!k.isTouchDevice()&&ee(e)}}),ze=w(It,2),gt=ze[0],xt=ze[1],Be=function(){if(!de.current){de.current=k.createInlineStyle(s&&s.nonce||ye.nonce,s&&s.styleContainer);var e="".concat(I),u=`
@media screen and (max-width: `.concat(o.breakpoint,`) {
    .p-contextmenu[`).concat(e,`] > ul {
        max-height: `).concat(o.scrollHeight,`;
        overflow: `).concat(o.scrollHeight?"auto":"",`;
    }

    .p-contextmenu[`).concat(e,`] .p-submenu-list {
        position: relative;
    }

    .p-contextmenu[`).concat(e,`] .p-menuitem-active > .p-submenu-list {
        left: 0;
        box-shadow: none;
        border-radius: 0;
        padding: 0 0 0 calc(var(--inline-spacing) * 2); /* @todo */
    }

    .p-contextmenu[`).concat(e,`] .p-menuitem-active > .p-menuitem-link > .p-submenu-icon {
        transform: rotate(-180deg);
    }

    .p-contextmenu[`).concat(e,`] .p-submenu-icon:before {
        content: "\\e930";
    }
}
`);de.current.innerHTML=u}},Ze=function(){de.current=k.removeInlineStyle(de.current)},ht=function(){d(!1)},St=function(){d(!1)},Ae=function(e){Z([]),L({index:-1,level:0,parentKey:""}),e.stopPropagation(),e.preventDefault(),ie.current=e,R?F(!0):(K(!0),o.onShow&&o.onShow(ie.current)),Promise.resolve().then(function(){Q.current&&k.focus(Q.current.getElement())})},ee=function(e){ie.current=e,K(!1),F(!1),Z([]),L({index:-1,level:0,parentKey:""}),o.onHide&&o.onHide(ie.current)},Et=function(){k.addStyles(x.current,{position:"absolute"}),o.autoZIndex&&we.set("menu",x.current,s&&s.autoZIndex||ye.autoZIndex,o.baseZIndex||s&&s.zIndex.menu||ye.zIndex.menu),Mt(ie.current),I&&o.breakpoint&&(x.current.setAttribute(I,""),Be())},kt=function(){Ct()},Pt=function(){Ot(),we.clear(x.current)},wt=function(){we.clear(x.current),Ze()},Mt=function(e){if(e){var u=e.pageX+1,l=e.pageY+1,S=x.current.offsetParent?x.current.offsetWidth:k.getHiddenElementOuterWidth(x.current),E=x.current.offsetParent?x.current.offsetHeight:k.getHiddenElementOuterHeight(x.current),A=k.getViewport();u+S-document.body.scrollLeft>A.width&&(u=u-S),l+E-document.body.scrollTop>A.height&&(l=l-E),u<document.body.scrollLeft&&(u=document.body.scrollLeft),l<document.body.scrollTop&&(l=document.body.scrollTop),x.current.style.left=u+"px",x.current.style.top=l+"px"}},Te=c.useCallback(function(i,e){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",S=[];return i&&i.forEach(function(E,A){var se=(l!==""?l+"_":"")+A,te={item:E,index:A,level:e,separator:E.separator,key:se,parent:u,parentKey:l};te.items=Te(E.items,e+1,te,se),S.push(te)}),S},[]),Lt=function(e){d(!0),ee(e),e.stopPropagation()},Rt=function(e){return x&&x.current&&!(x.current.isSameNode(e.target)||x.current.contains(e.target))},Ct=function(){gt(),vt()},Ot=function(){xt(),pt()};dn(function(){var i=bn();!b&&_(i),o.global&&Ve(),o.breakpoint&&!I&&J(i)}),ne(function(){o.global&&Ve()},[o.global]),ne(function(){return I&&x.current&&(x.current.setAttribute(I,""),Be()),function(){Ze()}},[I,o.breakpoint]),ne(function(){R?(K(!1),F(!1),d(!0)):!N&&!R&&X&&Ae(ie.current)},[N]),c.useEffect(function(){var i=o.model||[],e=Te(i,0,null,"");Ce(e)},[o.model,Te]),ne(function(){var i=m.index!==-1?"".concat(b).concat(O.isNotEmpty(m.parentKey)?"_"+m.parentKey:"","_").concat(m.index):null;le(i)},[m]),ne(function(){var i=C&&C.find(function(u){return u.key===m.parentKey}),e=i?i.items:Se;Ke(e)},[C,m]),ne(function(){if(f){var i=m.index!==-1?Ge(m.index):ve();oe(i),Z(C.filter(function(e){return e.parentKey!==m.parentKey})),v(!1)}},[f]),mn(function(){we.clear(x.current)}),c.useImperativeHandle(a,function(){return{props:o,show:Ae,hide:ee,getElement:function(){return x.current}}});var Kt=function(e){z(!0),L(m.index!==-1?m:{index:-1,level:0,parentKey:""}),o.onFocus&&o.onFocus(e)},_t=function(e){z(!1),L({index:-1,level:0,parentKey:""}),W.current="",W.current="",o.onBlur&&o.onBlur(e)},Dt=function(e){var u=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":At(e);break;case"ArrowUp":Tt(e);break;case"ArrowLeft":$t(e);break;case"ArrowRight":Ft(e);break;case"Home":Ht(e);break;case"End":Ut(e);break;case"Space":Vt(e);break;case"Enter":case"NumpadEnter":We(e);break;case"Escape":zt(e);break;case"Tab":Bt();break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!u&&O.isPrintableCharacter(e.key)&&Zt(e,e.key);break}},me=function(e){var u=e.processedItem,l=e.isFocus,S=e.updateState,E=S===void 0?!0:S;if(!O.isEmpty(u)){var A=u.index,se=u.key,te=u.level,pe=u.parentKey,rn=u.items,an=O.isNotEmpty(rn),Qe=C.filter(function(et){return et.parentKey!==pe&&et.parentKey!==se});an&&E&&(Qe.push(u),K(!0)),L({index:A,level:te,parentKey:pe}),Z(Qe),l&&k.focus(Q.current.getElement())}},Nt=function(e){var u=e.processedItem,l=fe(u),S=Xe(u);if(S){var E=u.index,A=u.key,se=u.level,te=u.parentKey;Z(C.filter(function(pe){return A!==pe.key&&A.startsWith(pe.key)})),L({index:E,level:se,parentKey:te}),k.focus(Q.current.getElement())}else l?me(e):ee()},jt=function(e){me(e)},At=function(e){var u=m.index!==-1?Ge(m.index):ve();oe(u),e.preventDefault()},Tt=function(e){if(e.altKey){if(m.index!==-1){var u=P[m.index],l=fe(u);!l&&me({processedItem:u})}e.preventDefault()}else{var S=m.index!==-1?Yt(m.index):en();oe(S),e.preventDefault()}},$t=function(e){var u=P[m.index],l=C.find(function(E){return E.key===u.parentKey}),S=O.isEmpty(u.parent);S||(L({index:-1,parentKey:l?l.parentKey:""}),W.current="",setTimeout(function(){return v(!0)},0)),e.preventDefault()},Ft=function(e){var u=P[m.index],l=fe(u);l&&(me({processedItem:u}),L({index:-1,parentKey:u.key}),W.current="",setTimeout(function(){return v(!0)},0)),e.preventDefault()},Ht=function(e){oe(Je()),e.preventDefault()},Ut=function(e){oe(qe()),e.preventDefault()},We=function(e){if(m.index!==-1){var u=k.findSingle(Q.current.getElement(),'li[id="'.concat("".concat(ae),'"]')),l=u&&k.findSingle(u,'a[data-pc-section="action"]');l?l.click():u&&u.click();var S=P[m.index],E=fe(S);!E&&L(Le(Le({},m),{},{index:ve()}))}e.preventDefault()},Vt=function(e){We(e)},zt=function(e){ee(),L({focusedItemInfo:m,index:ve()}),e.preventDefault()},Bt=function(e){if(m.index!==-1){var u=P[m.index],l=fe(u);!l&&me({processedItem:u})}ee()},Zt=function(e,u){W.current=W.current||""+u;var l=-1,S=!1;return m.index!==-1?(l=P.slice(m.index).findIndex(function(E){return Fe(E)}),l=l===-1?P.slice(0,m.index).findIndex(function(E){return Fe(E)}):l+m.index):l=P.findIndex(function(E){return Fe(E)}),l!==-1&&(S=!0),l===-1&&m.index===-1&&(l=ve()),l!==-1&&oe(l),Pe.current&&clearTimeout(Pe.current),Pe.current=setTimeout(function(){W.current="",Pe.current=null},500),S},oe=function(e){m.index!==e&&(L(Le(Le({},m),{},{index:e})),Wt())},Wt=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,u=e!==-1?"".concat(b,"_").concat(e):ae,l=k.findSingle(Q.current.getElement(),'li[id="'.concat(u,'"]'));l&&l.scrollIntoView&&l.scrollIntoView({block:"nearest",inline:"start"})},$e=function(e,u){return e?O.getItemValue(e[u]):void 0},Gt=function(e){return $e(e,"label")},Xt=function(e){return e?Gt(e.item):void 0},fe=function(e){return e&&O.isNotEmpty(e.items)},Jt=function(e){return $e(e,"disabled")},qt=function(e){return $e(e,"separator")},ue=function(e){return!!e&&!Jt(e.item)&&!qt(e.item)},Fe=function(e){return ue(e)&&Xt(e).toLocaleLowerCase().startsWith(W.current.toLocaleLowerCase())},Ge=function(e){var u=e<P.length-1?P.slice(e+1).findIndex(function(l){return ue(l)}):-1;return u>-1?u+e+1:e},Yt=function(e){var u=e>0?O.findLastIndex(P.slice(0,e),function(l){return ue(l)}):-1;return u>-1?u:e},Xe=function(e){return C&&C.some(function(u){return u.key===e.key})},Qt=function(e){return ue(e)&&Xe(e)},Je=function(){return P.findIndex(function(e){return ue(e)})},qe=function(){return O.findLastIndex(P,function(e){return ue(e)})},ve=function(){var e=Ye();return e<0?Je():e},en=function(){var e=Ye();return e<0?qe():e},Ye=function(){return P.findIndex(function(e){return Qt(e)})},tn=function(){var e=n({id:o.id,className:be(o.className,je("root",{context:s})),style:o.style,onClick:function(S){return ht()},onMouseEnter:function(S){return St()}},Me.getOtherProps(o),Ne("root")),u=n({classNames:je("transition"),in:R,timeout:{enter:250,exit:0},options:o.transitionOptions,unmountOnExit:!0,onEnter:Et,onEntered:kt,onExit:Pt,onExited:wt},Ne("transition"));return c.createElement(st,G({nodeRef:x},u),c.createElement("div",G({ref:x},e),c.createElement(He,{ref:Q,ariaLabel:o.ariaLabel,ariaLabelledby:o.ariaLabelledby,activeItemPath:C,hostName:"ContextMenu",id:b+"_list",role:"menubar",tabIndex:o.tabIndex||0,ariaActivedescendant:Y?ae:void 0,menuId:b,focusedItemId:Y?ae:void 0,menuProps:o,model:Se,level:0,root:!0,onItemClick:Nt,onItemMouseEnter:jt,onFocus:Kt,onBlur:_t,onKeyDown:Dt,resetMenu:X,onLeafClick:Lt,isMobileMode:mt,submenuIcon:o.submenuIcon,ptm:Ne,cx:je})))},nn=tn();return c.createElement(fn,{element:nn,appendTo:o.appendTo})}));lt.displayName="ContextMenu";function $n(){const[t,a]=c.useState(!0),[n,s]=c.useState([]),[o,M]=c.useState(null),[y,b]=c.useState({}),[_,T]=c.useState(!1),D=c.useRef(null);function R(d="/"){try{return En(d).filter(p=>p!=="."&&p!=="..").map(p=>{const I=d==="/"?`/${p}`:`${d}/${p}`,J=kn(I),q=J.isSymbolicLink(),j=J.isDirectory()&&!q,Y=j?R(I):void 0,z=j?Y.reduce((g,r)=>r.data?.size?g+r.data.size:g,0):J.size;return{key:I,label:z!==void 0?`${p} (${Pn(z)})`:p,data:{path:I,isDir:j,isSymlink:q,size:z},icon:q?"pi pi-link":j?"pi pi-folder":"pi pi-file",leaf:!j,children:Y}})}catch(h){return console.error(h),[]}}c.useEffect(()=>{(async()=>(console.log("Creating ZenFS filesystem"),await gn(!0),s(R("/")),a(!1)))()},[]);function K(d,h,p){return d.map(I=>I.key===h?{...I,children:p}:I.children?{...I,children:K(I.children,h,p)}:I)}const $=()=>{const d={};for(const h of n)N(h,d);b(d)},U=()=>{b({})},N=(d,h)=>{if(d.children&&d.children.length){h[d.key]=!0;for(const p of d.children)N(p,h)}},F=d=>{if(y[d]){const{[d]:h,...p}=y;b(p)}else b({...y,[d]:!0})},re=[{label:"Expand All",icon:"pi pi-plus",command:$},{label:"Collapse All",icon:"pi pi-minus",command:U}];function V(d){const h=y,p=R(d);T(!0),s(I=>K(I,d,p)),b({...h,[d]:!0}),T(!1)}const X=[{label:"Refresh",icon:"pi pi-refresh",disabled:o?.leaf,command:()=>{o&&typeof o.key=="string"?V(o.key):alert("selectedNode is null or not a string. Cannot refresh.")}},{label:"Open Scaddle",icon:"pi pi-link",disabled:!o?.leaf&&!((o?.key?.match(/^\/src\//)?.length??0)>0),command:()=>{const d=(o?.key).match(/^\/src\/([^/]+)\/?/);if(!d)throw new Error("No match found");window.open("#/model/"+d[1],"_blank")}},{label:"Download",icon:"pi pi-download",disabled:!o?.leaf,command:()=>{if(o&&typeof o.key=="string"){const d=xn(o.key),h=new Blob([d],{type:"application/octet-stream"}),p=document.createElement("a");p.href=URL.createObjectURL(h),p.download=o.key.split("/").pop()||"file",document.body.appendChild(p),p.click(),setTimeout(()=>{document.body.removeChild(p),URL.revokeObjectURL(p.href)},100)}}},{label:"Delete",icon:"pi pi-trash",command:()=>{if(o&&typeof o.key=="string"){hn(o.key,{recursive:!0});const d=o.key.substring(0,o.key.lastIndexOf("/"));V(d)}}}];return ce.jsx("div",{className:"page",children:t?ce.jsx(yn,{text:"Loading filesystem"}):ce.jsxs("div",{children:[ce.jsx(In,{model:re,className:"mb-4"}),ce.jsx(lt,{model:X,ref:D}),ce.jsx(Sn,{value:n,selectionMode:"single",filter:!0,filterMode:"lenient",filterPlaceholder:"filter",expandedKeys:y,onToggle:d=>{if(d.value&&Object.keys(d.value).length!==0)b(d.value);else{const h=y;b(d.value),setTimeout(()=>b(h),100)}},onNodeClick:d=>{_||F(d.node.key)},onContextMenu:d=>{M(d.node),D.current.show(d.originalEvent)}})]})})}export{$n as default};
