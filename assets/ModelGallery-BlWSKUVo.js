import{z as w,r,j as e,C as B}from"../index.js";import{SupabaseService as C}from"./SupabaseService-CnFb_Wi5.js";import{a as L}from"./ModelCard-DbVTjNbq.js";import{P as M}from"./paginator.esm-C2mMQgrX.js";import{B as T}from"./badge.esm-JJKfF79Z.js";import"./utils-CKaYmvp5.js";import"./dropdown.esm-CoEZyfAG.js";import"./index.esm-BHvanpNW.js";function H({filter:i,style:p,pageSize:d=20,pagination:x=!0}){const{tag:g}=w();g&&(i={...i,tag:g});const[u,j]=r.useState([]),[h,y]=r.useState(0),[m,f]=r.useState(0),[P,b]=r.useState(!0),[c,v]=r.useState([]);r.useEffect(()=>{async function s(){const{models:t,total:a}=await C.fetchModels(i,m,d);j(t),y(a);const l={};t.forEach(o=>{(o.tags||[]).forEach(n=>{l[n]=(l[n]||0)+1})});const k=Object.entries(l).map(([o,n])=>({key:o,tag:o,count:n})).sort((o,n)=>n.count-o.count||o.tag.localeCompare(n.tag));v(k),b(!1)}s()},[m,d,i]);function F(s){if(!s)return e.jsx(e.Fragment,{});const t=l=>e.jsx("span",{style:{color:"var(--theme-color)"},children:l}),a=[e.jsx(e.Fragment,{children:"Models"})];return s.tag&&a.push(e.jsxs(e.Fragment,{children:[" tagged with ",t(s.tag)]})),s.author&&a.push(e.jsxs(e.Fragment,{children:[" authored by ",t(s.author)]})),s.likedByUsername&&a.push(e.jsxs(e.Fragment,{children:[" liked by ",t(s.likedByUsername)]})),s.commentedByUsername&&a.push(e.jsxs(e.Fragment,{children:[" commented by ",t(s.commentedByUsername)]})),s.searchTerm&&a.push(e.jsxs(e.Fragment,{children:[" containing ",t(s.searchTerm)]})),e.jsx("h1",{style:{flex:0,marginLeft:"auto",marginRight:"auto",marginBottom:0},children:a})}return e.jsxs("div",{style:{...p,display:"flex",flexDirection:"column",gap:16,width:"100%"},children:[F(i),P?e.jsx(B,{text:"Loading models"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"model-gallery",children:[u.map(s=>e.jsx(L,{model:s},s.id)),u.length===0&&e.jsx("div",{style:{gridColumn:"1 / -1"},children:"No models found."})]}),x&&h>d&&e.jsx(M,{first:m,rows:d,totalRecords:h,onPageChange:s=>f(s.first),template:"PrevPageLink PageLinks NextPageLink",rowsPerPageOptions:[],style:{flex:0,marginLeft:"auto",marginRight:"auto"}}),c&&c.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:c.map(({tag:s,count:t})=>e.jsxs("a",{href:`/#/tag/${s}`,className:"p-button p-button-outlined",children:["#",s,e.jsx(T,{value:t,style:{background:"#333"}},s)]},s))})]})]})}export{H as default};
