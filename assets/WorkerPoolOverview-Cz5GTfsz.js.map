{"version":3,"file":"WorkerPoolOverview-Cz5GTfsz.js","sources":["../../src/components/WorkerPoolOverview.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { WorkerPoolStatus } from '../services/simple-worker-pool/simple-worker-pool.ts';\nimport { Badge } from 'primereact/badge';\nimport { workerPool } from '../services/openscad-wasm-runner/openscad-runner.ts';\n\nconst STATUS_COLORS: Record<string, string> = {\n  idle: '#888',\n  busy: '#00e676',\n  cleanup: '#ffd600',\n  error: '#ff1744',\n  terminated: '#333',\n};\nconst QUEUE_COLOR = (len: number) => (len > 0 ? '#ffd600' : '#888');\nconst NO_STATUS_COLOR = '#660000';\n\nexport default function WorkerPoolOverview() {\n  const [workerPoolStatus, setWorkerPoolStatus] = useState<WorkerPoolStatus>({\n    workers: [],\n    taskQueueLength: -1,\n  });\n  useEffect(() => {\n    if (workerPoolStatus.taskQueueLength != -1) return; // already subscribed\n    workerPool.subscribeStatus((status) => setWorkerPoolStatus(status));\n  }, [workerPoolStatus.taskQueueLength]);\n\n  if (workerPoolStatus.taskQueueLength === -1) {\n    return (\n      <Badge\n        key=\"noWorkerStatus\"\n        style={{ background: NO_STATUS_COLOR, minWidth: 16, minHeight: 16, color: '#fff' }}\n      />\n    );\n  } else {\n    return (\n      <div style={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n        <i className=\"pi pi-hammer\" title=\"OpenSCAD worker pool overview\"></i>\n        {workerPoolStatus.workers.map((worker) => (\n          <Badge\n            style={{\n              background: STATUS_COLORS[worker.status] || '#888',\n              color: '#fff',\n            }}\n            key={worker.id}\n            value={worker.id}\n            title={'Worker ' + worker.id}\n          />\n        ))}\n        <Badge\n          key=\"taskQueueLength\"\n          value={workerPoolStatus.taskQueueLength}\n          style={{\n            background: QUEUE_COLOR(workerPoolStatus.taskQueueLength),\n            color: '#fff',\n          }}\n          title={`Task queue length: ${workerPoolStatus.taskQueueLength}`}\n        />\n      </div>\n    );\n  }\n}\n"],"names":["STATUS_COLORS","QUEUE_COLOR","len","NO_STATUS_COLOR","WorkerPoolOverview","workerPoolStatus","setWorkerPoolStatus","useState","useEffect","workerPool","status","jsx","Badge","jsxs","worker"],"mappings":"qIAKA,MAAMA,EAAwC,CAC5C,KAAM,OACN,KAAM,UACN,QAAS,UACT,MAAO,UACP,WAAY,MACd,EACMC,EAAeC,GAAiBA,EAAM,EAAI,UAAY,OACtDC,EAAkB,UAExB,SAAwBC,GAAqB,CAC3C,KAAM,CAACC,EAAkBC,CAAmB,EAAIC,WAA2B,CACzE,QAAS,CAAA,EACT,gBAAiB,EAAA,CAClB,EAMD,OALAC,EAAAA,UAAU,IAAM,CACVH,EAAiB,iBAAmB,IACxCI,EAAW,gBAAiBC,GAAWJ,EAAoBI,CAAM,CAAC,CACpE,EAAG,CAACL,EAAiB,eAAe,CAAC,EAEjCA,EAAiB,kBAAoB,GAErCM,EAAAA,IAACC,EAAA,CAEC,MAAO,CAAE,WAAYT,EAAiB,SAAU,GAAI,UAAW,GAAI,MAAO,MAAA,CAAO,EAD7E,gBAAA,EAMNU,OAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,CAAA,EACxD,SAAA,CAAAF,EAAAA,IAAC,IAAA,CAAE,UAAU,eAAe,MAAM,gCAAgC,EACjEN,EAAiB,QAAQ,IAAKS,GAC7BH,EAAAA,IAACC,EAAA,CACC,MAAO,CACL,WAAYZ,EAAcc,EAAO,MAAM,GAAK,OAC5C,MAAO,MAAA,EAGT,MAAOA,EAAO,GACd,MAAO,UAAYA,EAAO,EAAA,EAFrBA,EAAO,EAAA,CAIf,EACDH,EAAAA,IAACC,EAAA,CAEC,MAAOP,EAAiB,gBACxB,MAAO,CACL,WAAYJ,EAAYI,EAAiB,eAAe,EACxD,MAAO,MAAA,EAET,MAAO,sBAAsBA,EAAiB,eAAe,EAAA,EANzD,iBAAA,CAON,EACF,CAGN"}